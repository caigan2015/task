{"version":3,"file":"js/history.bundle.js","sources":["webpack:///webpack/bootstrap eaa41e761dade7d1074b","webpack:///(webpack)/buildin/global.js","webpack:///./node_modules/_art-template@4.12.2@art-template/lib/runtime.js","webpack:///./node_modules/_art-template@4.12.2@art-template/lib/compile/runtime.js","webpack:///./node_modules/_detect-node@2.0.3@detect-node/index.js","webpack:///app/js/history.js","webpack:///./app/template/history.art","webpack:///./app/template/no_data_tips.art"],"sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 33);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap eaa41e761dade7d1074b","var g;\r\n\r\n// This works in non-strict mode\r\ng = (function() {\r\n\treturn this;\r\n})();\r\n\r\ntry {\r\n\t// This works if eval is allowed (see CSP)\r\n\tg = g || Function(\"return this\")() || (1,eval)(\"this\");\r\n} catch(e) {\r\n\t// This works if the window reference is available\r\n\tif(typeof window === \"object\")\r\n\t\tg = window;\r\n}\r\n\r\n// g can still be undefined, but nothing to do about it...\r\n// We return undefined, instead of nothing here, so it's\r\n// easier to handle this case. if(!global) { ...}\r\n\r\nmodule.exports = g;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// (webpack)/buildin/global.js\n// module id = 0\n// module chunks = 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15","'use strict';\n\nmodule.exports = require('./compile/runtime');\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_art-template@4.12.2@art-template/lib/runtime.js\n// module id = 1\n// module chunks = 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15","'use strict';\n\n/*! art-template@runtime | https://github.com/aui/art-template */\n\nvar detectNode = require('detect-node');\nvar runtime = Object.create(detectNode ? global : window);\nvar ESCAPE_REG = /[\"&'<>]/;\n\n/**\n * 编码模板输出的内容\n * @param  {any}        content\n * @return {string}\n */\nruntime.$escape = function (content) {\n    return xmlEscape(toString(content));\n};\n\n/**\n * 迭代器，支持数组与对象\n * @param {array|Object} data \n * @param {function}     callback \n */\nruntime.$each = function (data, callback) {\n    if (Array.isArray(data)) {\n        for (var i = 0, len = data.length; i < len; i++) {\n            callback(data[i], i);\n        }\n    } else {\n        for (var _i in data) {\n            callback(data[_i], _i);\n        }\n    }\n};\n\n// 将目标转成字符\nfunction toString(value) {\n    if (typeof value !== 'string') {\n        if (value === undefined || value === null) {\n            value = '';\n        } else if (typeof value === 'function') {\n            value = toString(value.call(value));\n        } else {\n            value = JSON.stringify(value);\n        }\n    }\n\n    return value;\n};\n\n// 编码 HTML 内容\nfunction xmlEscape(content) {\n    var html = '' + content;\n    var regexResult = ESCAPE_REG.exec(html);\n    if (!regexResult) {\n        return content;\n    }\n\n    var result = '';\n    var i = void 0,\n        lastIndex = void 0,\n        char = void 0;\n    for (i = regexResult.index, lastIndex = 0; i < html.length; i++) {\n\n        switch (html.charCodeAt(i)) {\n            case 34:\n                char = '&#34;';\n                break;\n            case 38:\n                char = '&#38;';\n                break;\n            case 39:\n                char = '&#39;';\n                break;\n            case 60:\n                char = '&#60;';\n                break;\n            case 62:\n                char = '&#62;';\n                break;\n            default:\n                continue;\n        }\n\n        if (lastIndex !== i) {\n            result += html.substring(lastIndex, i);\n        }\n\n        lastIndex = i + 1;\n        result += char;\n    }\n\n    if (lastIndex !== i) {\n        return result + html.substring(lastIndex, i);\n    } else {\n        return result;\n    }\n};\n\nmodule.exports = runtime;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_art-template@4.12.2@art-template/lib/compile/runtime.js\n// module id = 2\n// module chunks = 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15","module.exports = false;\n\n// Only Node.JS has a process variable that is of [[Class]] process\ntry {\n module.exports = Object.prototype.toString.call(global.process) === '[object process]' \n} catch(e) {}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_detect-node@2.0.3@detect-node/index.js\n// module id = 3\n// module chunks = 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15","//api/v1/order/by_user\r\n//订单状态 \r\n//-1已关闭 ！\r\n//0待支付！\r\n//1已支付 ！\r\n//2已超时 x\r\n//3退款中 x\r\n//4已退款x\r\n//5已取消！\r\n\r\nconst template = require('../template/history.art')\r\nconst no_data_tips_html = require('../template/no_data_tips.art')\r\n$(document).ready(function($) {\r\n\r\n    var page = 1;\r\n    var size = 10;\r\n\r\n    var opt = {};\r\n    opt.itemsPerLoad = size;\r\n    opt.page = page;\r\n    opt.maxItems = 0;\r\n    opt.lastIndex = 0;\r\n    opt.loading = false;\r\n    opt.ele = $(\"#page-history\");\r\n\r\n    addItem(opt);\r\n\r\n    $(\"#page-history\").infinite().on(\"infinite\", function() {\r\n        var self = this;\r\n        if (opt.loading) return;\r\n        opt.loading = true;\r\n        addItem(opt);\r\n    });\r\n\r\n\r\n\r\n    function addItem(opt) {\r\n        $._ajax({\r\n            type: \"get\",\r\n            url: domain + \"/api/v1/order/by_user\",\r\n            data: {\r\n                page: opt.page,\r\n                size: opt.itemsPerLoad\r\n            },\r\n            success: function(data) {\r\n                opt.ele.find(\"ul\").append(template(data));\r\n                console.log(data);\r\n                opt.lastIndex = opt.ele.find('ul>li').length;\r\n                opt.maxItems = data.total;\r\n                if (opt.lastIndex >= opt.maxItems) {\r\n                    // 加载完毕，则注销无限加载事件，以防不必要的加载\r\n                    opt.ele.destroyInfinite();\r\n                    // 删除加载提示符\r\n                    opt.ele.find(\".weui-loadmore\").remove();\r\n                }\r\n                opt.page++;\r\n                opt.loading = false;\r\n\r\n                if (data.total === 0) {\r\n                    opt.ele.html(no_data_tips_html());\r\n                    return false;\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    $(document).on('click', '#page-history .pay-btn', function(event) {\r\n        event.preventDefault();\r\n        /* Act on the event */\r\n        var curr_id = $(this).parents(\".weui-form-preview\").data(\"id\");\r\n        $._ajax({\r\n            url: domain + \"/api/v1/pay/pre_order\",\r\n            data: { id: curr_id },\r\n            success: function(data) {\r\n                wx.chooseWXPay({\r\n                    timestamp: data.timeStamp, // 支付签名时间戳，注意微信jssdk中的所有使用timestamp字段均为小写。但最新版的支付后台生成签名使用的timeStamp字段名需大写其中的S字符\r\n                    nonceStr: data.nonceStr, // 支付签名随机串，不长于 32 位\r\n                    package: data.package, // 统一支付接口返回的prepay_id参数值，提交格式如：prepay_id=***）\r\n                    signType: data.signType, // 签名方式，默认为'SHA1'，使用新版支付需传入'MD5'\r\n                    paySign: data.paySign, // 支付签名\r\n                    success: function(res) {\r\n                        console.log(res);\r\n                        $.toast(\"支付成功\", function() {\r\n                            window.location.href = \"user_center.html\"\r\n                        });\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    });\r\n\r\n\r\n\r\n    $(document).on('click', '#page-history .cancel-btn', function(event) {\r\n        event.preventDefault();\r\n        var curr_id = $(this).parents(\".weui-form-preview\").data(\"id\");\r\n        $._ajax({\r\n            url: domain + \"/api/v1/order/cancel\",\r\n            data: { id: curr_id },\r\n            success: function(data) {\r\n                console.log(data);\r\n                $.toast(\"取消成功\", function() { window.location.reload(); });\r\n\r\n            }\r\n        });\r\n\r\n    });\r\n\r\n    $(document).on('click', '#page-history .close-btn', function(event) {\r\n        event.preventDefault();\r\n        var curr_id = $(this).parents(\".weui-form-preview\").data(\"id\");\r\n        $._ajax({\r\n            url: domain + \"/api/v1/order/close\",\r\n            data: { id: curr_id },\r\n            success: function(data) {\r\n                console.log(data);\r\n                $.toast(\"关闭成功\", function() { window.location.reload(); });\r\n            }\r\n        });\r\n\r\n    });\r\n\r\n\r\n\r\n\r\n});\n\n\n// WEBPACK FOOTER //\n// app/js/history.js"," {{each data list i}}\r\n<li>\r\n    <div class=\"weui-form-preview\" data-id=\"{{list.id}}\">\r\n        <div class=\"weui-form-preview__hd\">\r\n            <div class=\"weui-form-preview__item\">\r\n                <label class=\"weui-form-preview__label\">商品/服务</label>\r\n                <em class=\"weui-form-preview__value\">{{list.name}}</em>\r\n            </div>\r\n        </div>\r\n        <div class=\"weui-form-preview__bd\">\r\n            <div class=\"weui-form-preview__item\">\r\n                <label class=\"weui-form-preview__label\">订单号</label>\r\n                <span class=\"weui-form-preview__value\">{{list.order_no}}</span>\r\n            </div>\r\n<!--             <div class=\"weui-form-preview__item\">\r\n                <label class=\"weui-form-preview__label\">价格</label>\r\n                <span class=\"weui-form-preview__value\">￥{{list.price}}</span>\r\n            </div>\r\n            <div class=\"weui-form-preview__item\">\r\n                <label class=\"weui-form-preview__label\">数量</label>\r\n                <span class=\"weui-form-preview__value\">{{list.count}}</span>\r\n            </div> -->\r\n            <div class=\"weui-form-preview__item\">\r\n                <label class=\"weui-form-preview__label\">支付金额</label>\r\n                <span class=\"weui-form-preview__value\">￥{{list.total_price}}</span>\r\n            </div>\r\n            <div class=\"weui-form-preview__item\">\r\n                <label class=\"weui-form-preview__label\">状态</label>\r\n              <!--  状态码{{list.status}} -->\r\n                <span class=\"weui-form-preview__value\">{{if list.status==0}}未支付{{else if list.status==1}}已完成{{else if list.status==-1}}已关闭{{else if list.status==5}}已取消{{/if}}</span>\r\n            </div>\r\n            <div class=\"weui-form-preview__item\">\r\n                <label class=\"weui-form-preview__label\">{{if list.status==1}}支付{{else}}下单{{/if}}时间</label>\r\n                <span class=\"weui-form-preview__value\">{{if list.status==1}}{{list.pay_time}}{{else}}{{list.create_time}}{{/if}}</span>\r\n            </div>\r\n        </div>\r\n        {{if !(list.status==-1||list.status==1)}}\r\n        <div class=\"weui-form-preview__ft\">\r\n            {{if list.status==0}}<a class=\"weui-form-preview__btn weui-form-preview__btn_primary pay-btn\" href=\"javascript:\">支付</a><a class=\"weui-form-preview__btn weui-form-preview__btn_default cancel-btn\" href=\"javascript:\">取消</a>\r\n            {{else if list.status!=0&&list.status!=-1&&list.status!=1}}<a class=\"weui-form-preview__btn weui-form-preview__btn_default close-btn\" href=\"javascript:\">关闭</a> {{/if}}\r\n        </div>\r\n        {{/if}}\r\n    </div>\r\n</li>\r\n{{/each}}\n\n\n// WEBPACK FOOTER //\n// ./app/template/history.art","<div class=\"weui-loadmore weui-loadmore_line\">\r\n  <span class=\"weui-loadmore__tips\">暂无数据</span>\r\n</div>\n\n\n// WEBPACK FOOTER //\n// ./app/template/no_data_tips.art"],"mappings":";AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;AC7DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;ACpBA;AACA;AACA;;;;;;;;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;AClGA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAzBA;AA2BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAXA;AAaA;AAjBA;AAmBA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAEA;AAPA;AAUA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AANA;AASA;AAKA;;;;;;;;;;;AC7HA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AA6BA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AA7BA;AAAA;AAgCA;AAAA;AAAA;AAAA;AAhCA;AAAA;AAiCA;AAAA;AAAA;AAAA;AAjCA;AAAA;AAoCA;AAAA;AAEA;AAAA;AACA;AAAA;AAHA;AAAA;AApCA;AAAA;;;;;;;;;;;;;;ACAA;;;;;;;A","sourceRoot":""}